import db from '@/lib/prismadb';
import MenuAdmin from 'components/admin/MenuAdmin';
import AdminLayout from 'components/admin/main-layout/AdminLayout';
import { headers } from 'next/headers';
import React, { Suspense } from 'react';

export const metadata = {
  title: 'Admin Create Next App',
  description: 'Generated by create next app',
}

async function getData() {
  const res = await fetch(process.env.NEXTAUTH_URL + '/api/admin/auth/me')
  if (!res.ok) {
    return {user: null}
  }

  return res.json();
}

export default async function AdminRootLayout({
  children,
}: {
  children: React.ReactNode;
}) {

  const { user: data } = await getData();

  return (
    <AdminLayout userData={data}>{children}</AdminLayout>
  )
}